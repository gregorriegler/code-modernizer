# Refactoring Plan

## Identified Issues to Improve

### 1. Duplicated Code - AutoGeneratedTool and AutoGeneratedAnalysisTool
The [`AutoGeneratedTool`](modernizer/tools/auto_generated_tool.py:3) and [`AutoGeneratedAnalysisTool`](modernizer/tools/auto_generated_analysis_tool.py:3) classes are nearly identical (95% duplication). They differ only in:
- Default description text ("Refactoring tool" vs "Analysis tool")
- Project path in execute method (RoslynRefactoring vs RoslynAnalysis)

### 2. Long Method - MutationTool._read_stryker_report()
The [`MutationTool._read_stryker_report()`](modernizer/tools/mutation_tool.py:45) method is 42 lines long and handles multiple responsibilities:
- Directory path resolution
- File system traversal
- Report file discovery
- File reading and error handling

### 3. Long Method - ToolLibrary.parse_and_execute()
The [`ToolLibrary.parse_and_execute()`](modernizer/tools/tool_library.py:80) method is 38 lines long and handles:
- Multi-line vs single-line command detection
- Regex pattern matching
- Command parsing
- Tool execution

### 4. Long Method - MutationTool._calculate_mutation_statistics()
The [`MutationTool._calculate_mutation_statistics()`](modernizer/tools/mutation_tool.py:115) method is 35 lines long and handles:
- Statistics calculation
- Mutant processing
- Survived mutant collection
- Score calculation

## Refactoring Tasks

- [x] Extract superclass: Create `BaseAutoGeneratedTool` to eliminate duplication between `AutoGeneratedTool` and `AutoGeneratedAnalysisTool`
- [x] Extract method: Create `_resolve_stryker_output_directory()` in MutationTool to handle directory path resolution
- [x] Extract method: Create `_find_latest_report_file()` in MutationTool to handle report file discovery
- [x] Extract method: Create `_parse_multiline_command()` in ToolLibrary to handle multi-line command processing
- [x] Extract method: Create `_parse_single_line_command()` in ToolLibrary to handle single-line command processing
- [x] Extract method: Create `_process_mutants()` in MutationTool to handle mutant processing logic
- [x] Improve variable names: Rename `cmd` to `command` in ToolLibrary.runcommand()
- [x] Remove dead code: Remove unused `_calculate_mutation_score()` method (logic is inlined)
- [x] Consolidate test files: Join all cat tests into a single test file
